<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}</title>
  <meta name="description" content="{{ site.description }}">
  {% comment %}
  <!-- @TODO: Fix! -->
  <link rel="canonical" href="{{ page.url | replace: 'index.html', '' | prepend: site.baseurl | prepend: site.url }}">
  {% endcomment %}

  <link rel="stylesheet" href="{{ 'lib/font-awesome/font-awesome.min.css' | prepend: site.baseurl }}">
  <link rel="stylesheet" href="{{ 'lib/normalize/normalize.css' | prepend: site.baseurl }}">
  <link rel="stylesheet" href="{{ 'styles/main.css' | prepend: site.baseurl }}">

  <script src="{{ 'lib/modernizr/modernizr-custom.min.js' | prepend: site.baseurl }}"></script>
  <script src="{{ 'lib/svg4everybody/svg4everybody.min.js' | prepend: site.baseurl }}"></script>
  <script src="{{ 'lib/requestAnimationFrame/polyfill.js' | prepend: site.baseurl }}" defer="defer"></script>

  {% if page.nav_data or page.position_indicator %}
    <script src="{{ 'lib/smooth-scroll/smooth-scroll.min.js' | prepend: site.baseurl }}" defer="defer"></script>
  {% endif %}

  {% if page.position_indicator %}
    <script src="{{ 'lib/classList/classList.min.js' | prepend: site.baseurl }}"></script>
    <script src="{{ 'scripts/position-indicator.js' | prepend: site.baseurl }}" defer="defer"></script>
  {% endif %}

  {% if page.include_map %}
    <link rel="stylesheet" href="{{ 'lib/leaflet/leaflet.css' | prepend: site.baseurl }}" />
    <script src="{{ 'lib/leaflet/leaflet.js' | prepend: site.baseurl }}" defer="defer"></script>
    <script src="{{ 'scripts/reach-map.js' | prepend: site.baseurl }}" defer="defer"></script>
  {% endif %}

  {% if page.include_share_widgets %}
    <script type="text/javascript">
      var switchTo5x = true;
    </script>
    <script src="http://w.sharethis.com/button/buttons.js" defer="defer"></script>
  {% endif %}

  <script src="{{ 'lib/jRespond/js/jRespond.min.js' | prepend: site.baseurl }}"></script>
  <script src="{{ 'scripts/header-drop-down.js' | prepend: site.baseurl }}" defer="defer"></script>

  <script>
    DG = {
      // An URL pointing to the root of the site.
      baseUrl: '{{ site.baseurl  | prepend: site.url}}',

      // Load script and execute the callback function upon success.
      _loadedScripts: [],
      loadScript: function(src, callback) {
        // NOTE: Make sure the callback can be executed multiple times.
        if (this._loadedScripts.indexOf(src) != -1) {
          callback();
          return;
        }

        var script = document.createElement('script');
        document.body.appendChild(script);

        callback && (script.onload = callback);
        script.src = src;

        this._loadedScripts.push(src);
      },

      // Define breakpoints matching those in SASS.
      // @TODO: Have these generated by SASS.
      breakPoints: function(point) {
        var gen_column_width = 4;
        var gen_gutter_width = 1;
        var base_font_size = 16;

        var break_points = {
          bp_small: (((gen_column_width + gen_gutter_width) * 8) + 4) * base_font_size,
          bp_medium: (((gen_column_width + gen_gutter_width) * 12) + 6) * base_font_size,
          bp_large: (((gen_column_width + gen_gutter_width) * 16) + 8) * base_font_size
        };

        if (point && point in break_points) {
          return break_points[point];
        }

        return break_points;
      }
    };
  </script>
</head>
